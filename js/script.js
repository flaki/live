!function(){function a(){var a=moment().add(s.extraTime);a.clone().diff(v)<0?b():a.clone().diff(w)<0?c():a.clone().diff(t)<0?d():a.clone().diff(x)<0?e():f()}function b(){g("before")&&(j(),h("Catch We Build SG LIVE"),m(),k(),u.setAttribute("data-state","before")),p("full")}function c(){g("pre")&&(l(),h("Catch We Build SG LIVE"),m(),i("radio",!1),u.setAttribute("data-state","pre")),p("full")}function d(){g("countdown")&&(l(),h("We Build SG LIVE is airing soon"),m(),i("live",!0),u.setAttribute("data-state","countdown")),p("short")}function e(){q("live",function(){g("during-live")&&(l(),h("We Build SG LIVE is airing now!"),n("join us in the chat and conversation below"),i("live",!0),u.setAttribute("data-state","during-live"))},function(){g("during-radio")&&(h("We Build SG LIVE just finished airing"),n("continue to join us in the chat below"),i("radio",!0),u.setAttribute("data-state","during-radio"))})}function f(){g("after")&&(l(),j(),o(),h("Catch We Build SG LIVE next episode!"),n("we will publish info on the next live show shortly"),u.setAttribute("data-state","after"))}function g(a){return u.getAttribute("data-state")!=a}function h(a){var b=document.getElementById("liveHeading");null==b&&(b=document.createElement("h3"),b.setAttribute("id","liveHeading"),u.appendChild(b)),b.innerHTML=a}function i(a,b){var c=document.getElementById("liveAudio");null==c&&(c=document.createElement("audio"),c.setAttribute("class","liveaudio"),c.setAttribute("id","liveAudio"),c.setAttribute("controls","controls"),u.appendChild(c)),c.src!=="http://listen.webuild.sg:8000/"+a&&c.setAttribute("src","http://listen.webuild.sg:8000/"+a),b&&c.play();var d=document.getElementById("liveChat");null==d&&(d=document.createElement("iframe"),d.setAttribute("id","liveChat"),d.setAttribute("class","livechat"),d.setAttribute("src","http://webchat.freenode.net?channels=webuildsg&uio=MT1mYWxzZSY5PXRydWUmMTE9NTEfe"),u.appendChild(d))}function j(){var a=document.getElementById("liveAudio");null!=a&&u.removeChild(a);var b=document.getElementById("liveChat");null!=b&&u.removeChild(b)}function k(){var a=document.createElement("p");a.setAttribute("id","liveTime"),a.innerHTML=t.format("D MMM YYYY, ddd @h:mm a Z")+" GMT",u.appendChild(a)}function l(){var a=document.getElementById("liveTime");null!=a&&u.removeChild(a)}function m(){var a=document.getElementById("liveCountdown");if(null==a){var b=document.createElement("p");b.setAttribute("class","countdown"),b.setAttribute("id","liveCountdown"),u.appendChild(b)}}function n(a){m();var b=document.getElementById("liveCountdown");b.innerHTML=a}function o(){var a=document.getElementById("liveCountdown");null!=a&&u.removeChild(a)}function p(a){var b=moment().add(s.extraTime);r=t.clone(),ms=r.diff(b,"milliseconds",!0),days=Math.floor(moment.duration(ms).asDays()),r.subtract("days",days),ms=r.diff(b,"milliseconds",!0),hours=Math.floor(moment.duration(ms).asHours()),r.subtract("hours",hours),ms=r.diff(b,"milliseconds",!0),minutes=Math.floor(moment.duration(ms).asMinutes()),r.subtract("minutes",minutes),ms=r.diff(b,"milliseconds",!0),seconds=Math.floor(moment.duration(ms).asSeconds()),diff="short"==a?"in <strong> "+seconds+"</strong>...":"in <strong>"+days+"</strong> days <strong>"+hours+"</strong> hours <strong>"+minutes+"</strong> minutes <strong>"+seconds+"</strong> seconds";var c=document.getElementById("liveCountdown");c.innerHTML=diff}function q(a,b,c){var d="http://listen.webuild.sg:8000/",e=new Audio(d+a);e.preLoad="none",e.pause(),window.setTimeout(function(){null!=e.error||e.networkState==HTMLMediaElement.NETWORK_NO_SOURCE||e.networkState==HTMLMediaElement.NETWORK_EMPTY?c():b(),e=null},2e3)}var r,s={extraTime:{days:0,hours:0,minutes:0},podcastTimeString:"2013-10-5 11:00 +0800",timeFormatString:"YYYY-MM-DD HH:mm Z",preMoment:{unit:"hours",amount:15},startMoment:{unit:"seconds",amount:15},stopMoment:{unit:"hours",amount:2}},t=moment(s.podcastTimeString,s.timeFormatString),u=document.getElementById("liveDiv"),v=t.clone().subtract(s.preMoment.unit,s.preMoment.amount),w=t.clone().subtract(s.startMoment.unit,s.startMoment.amount),x=t.clone().add(s.stopMoment.unit,s.stopMoment.amount);document.getElementsByTagName("header")[0].addEventListener("click",function(){window.parent.location.href="/"}),a(),setInterval(a,1e3)}();